{% extends 'event/eventbase.html' %} {% load static %}

{% block title %}
    {{ event.judul_event }} | {{ kategori.judul_kategori }} | Ambrilindo
{% endblock title %}

{% block content %}
    {% url 'keldetailkategori' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' as putra_url %}
    {% url 'keldetailkategori' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putri' as putri_url %}
    <h1 class="h3 mb-3"><strong>Control Panel {{ tatami }}</strong> {{ bagan.judul_bagan }}</h1>

    <hr>

    <audio id="timerSound">
        <source src="{% static 'audio/asdf2.mp3' %}" type="audio/mpeg">
    </audio>

    <h1 style="display: none;" id="banyaknya_juri">{{ penilaian_juri }}</h1>

    <button onclick="openNewTab1('{{ detail_bagan.pk }}')"  
        {% if putra_url in request.path %} 
            data-url="{% url 'scoringboard1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}" 
        {% elif putri_url in request.path %}
            data-url="{% url 'scoringboard1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putri' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}" 
        {% endif %} class="btn" style="background-color: black; color: white; height: -10px">
        <i class="align-middle" data-feather="eye"></i>
        Tampilkan Scoring Board
    </button>

    {% if bagan.bendera == True %}
    <br>
    <br>
    <h3>
        <b style="color: blue; background-color: black; border-radius: 10px; padding: 5px;">{{ atlet2 }}</b>
        
        <b>vs</b> 
        <b style="color: red; background-color: black; border-radius: 10px; padding: 5px;">{{ atlet1 }}</b> 
    </h3>

    <div class="row" style="margin-top: 10px;" >
        <div class="d-flex order-1 order-xxl-1">
            <div class="card flex-fill">
                <div class="card-header">
                    <h5 class="card-title mb-0">Scoring <b>{{ tatami }}</b></h5>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover my-0">
                        <thead>
                            <tr>
                                <th>Jury 1</th>
                                <th>Jury 2</th>
                                <th>Jury 3</th>
                                {% if penilaian_juri != 3 %}
                                <th>Jury 4</th>
                                <th>Jury 5</th>
                                {% endif %}
                                {% if penilaian_juri == 7 %}
                                <th>Jury 6</th>
                                <th>Jury 7</th>
                                {% endif %}
                                <th style="text-align: center;">Winner</th>
                                <th>MISC</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                    <!-- Score 1 -->
                                    <td style="font-size: 30px;">
                                        <div {% if score1j1.jury_score != 20 %} style="display: none;" {% endif %} id="bendera1merah">
                                            <img src="{% static 'images/bendera-merah.png' %}" alt="" style="width: 50px">
                                        </div>
                                        <div {% if score1j1.jury_score != 30 %} style="display: none;" {% endif %}id="bendera1biru">
                                            <img src="{% static 'images/bendera-biru.png' %}" alt="" style="width: 45px">
                                        </div>
                                        <div {% if score1j1 == 'Belum Dikirim' or score1j1 is None %} style="" {% else %} style="display: none" {% endif %} id="bendera1">
                                            -
                                        </div>
                                        <b id="score1j1" style="display: none;">
                                        </b>
                                    </td>
                                    <!-- Score 2 -->
                                    <td style="font-size: 30px;">
                                        <div {% if score1j2.jury_score != 20 %} style="display: none;" {% endif %} id="bendera2merah">
                                            <img src="{% static 'images/bendera-merah.png' %}" alt="" style="width: 50px">
                                        </div>
                                        <div {% if score1j2.jury_score != 30 %} style="display: none;" {% endif %}id="bendera2biru">
                                            <img src="{% static 'images/bendera-biru.png' %}" alt="" style="width: 45px">
                                        </div>
                                        <div {% if score1j2 == 'Belum Dikirim' or score1j2 is None %} style="" {% else %} style="display: none" {% endif %} id="bendera2">
                                            -
                                        </div>
                                        <b id="score1j2" style="display: none;">
                                        </b>
                                    </td>
                                    <!-- Score 3 -->
                                    <td style="font-size: 30px;">
                                        <div {% if score1j3.jury_score != 20 %} style="display: none;" {% endif %} id="bendera3merah">
                                            <img src="{% static 'images/bendera-merah.png' %}" alt="" style="width: 50px">
                                        </div>
                                        <div {% if score1j3.jury_score != 30 %} style="display: none;" {% endif %}id="bendera3biru">
                                            <img src="{% static 'images/bendera-biru.png' %}" alt="" style="width: 45px">
                                        </div>
                                        <div {% if score1j3 == 'Belum Dikirim' or score1j3 is None %} style="" {% else %} style="display: none" {% endif %} id="bendera3">
                                            -
                                        </div>
                                        <b id="score1j3" style="display: none;">
                                        </b>
                                    </td>
                                    {% if penilaian_juri != 3 %}
                                    <!-- Score 4 -->
                                    <td style="font-size: 30px;">
                                        <div {% if score1j4.jury_score != 20 %} style="display: none;" {% endif %} id="bendera4merah">
                                            <img src="{% static 'images/bendera-merah.png' %}" alt="" style="width: 50px">
                                        </div>
                                        <div {% if score1j4.jury_score != 30 %} style="display: none;" {% endif %}id="bendera4biru">
                                            <img src="{% static 'images/bendera-biru.png' %}" alt="" style="width: 45px">
                                        </div>
                                        <div {% if score1j4 == 'Belum Dikirim' or score1j4 is None %} style="" {% else %} style="display: none" {% endif %} id="bendera4">
                                            -
                                        </div>
                                        <b id="score1j4" style="display: none;">
                                        </b>
                                    </td>
                                    <!-- Score 5 -->
                                    <td style="font-size: 30px;">
                                        <div {% if score1j5.jury_score != 20 %} style="display: none;" {% endif %} id="bendera5merah">
                                            <img src="{% static 'images/bendera-merah.png' %}" alt="" style="width: 50px">
                                        </div>
                                        <div {% if score1j5.jury_score != 30 %} style="display: none;" {% endif %}id="bendera5biru">
                                            <img src="{% static 'images/bendera-biru.png' %}" alt="" style="width: 45px">
                                        </div>
                                        <div {% if score1j5 == 'Belum Dikirim' or score1j5 is None %} style="" {% else %} style="display: none" {% endif %} id="bendera5">
                                            -
                                        </div>
                                        <b id="score1j5" style="display: none;">
                                        </b>
                                    </td>
                                    {% endif %}
                                    {% if penilaian_juri == 7 %}
                                    <!-- Score 6 -->
                                    <td style="font-size: 30px;">
                                        <div style="display: none" id="bendera6merah">
                                            <img src="{% static 'images/bendera-merah.png' %}" alt="" style="width: 50px">
                                        </div>
                                        <div style="display: none" id="bendera6biru">
                                            <img src="{% static 'images/bendera-biru.png' %}" alt="" style="width: 45px">
                                        </div>
                                        <div style="" id="bendera6">
                                            -
                                        </div>
                                        <b id="score1j6" style="display: none;">
                                        </b>
                                    </td>
                                    <!-- Score 7 -->
                                    <td style="font-size: 30px;">
                                        <div style="display: none" id="bendera7merah">
                                            <img src="{% static 'images/bendera-merah.png' %}" alt="" style="width: 50px">
                                        </div>
                                        <div style="display: none" id="bendera7biru">
                                            <img src="{% static 'images/bendera-biru.png' %}" alt="" style="width: 45px">
                                        </div>
                                        <div style="" id="bendera7">
                                            -
                                        </div>
                                        <b id="score1j7" style="display: none;">
                                        </b>
                                    </td>
                                    {% endif %}
                                
                                    <td style="text-align: center;">
                                        <span class="badge bg-dark" style="font-size: 50px;">
                                            <div {% if winner != 'merah' %}% style="display: none" {% endif %} id="benderamerah">
                                                <img src="{% static 'images/bendera-merah.png' %}" alt="" style="width: 70px">
                                            </div>
                                            <div {% if winner != 'biru' %} style="display: none" {% endif %} id="benderabiru">
                                                <img src="{% static 'images/bendera-biru.png' %}" alt="" style="width: 63px">
                                            </div>
                                            <div {% if bendera == 'none' %} style="" {% else %} style = "display: none" {% endif %} id="bendera">
                                                -
                                            </div>
                                        </span>
                                        <span id="totalscore1" class="badge bg-dark" style="font-size: 30px; display: none;">
                                        </span>
                                    </td>
                                    <td id="penilaianbtn1" data-url="{% url 'mulaipenilaian1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                        {% if detailbagan.peserta1 and not detailbagan.peserta1_telahdinilai %}
                                            <a href="{% url 'mulaipenilaian1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                                <span style="font-size: 30px;" class="badge bg-success">
                                                    NOW
                                                </span>
                                            </a>
                                            {% elif detailbagan.peserta1_telahdinilai %}
                                            <span style="font-size: 20px;" class="badge bg-success">
                                                Telah Dinilai
                                            </span>
                                            {% elif detailbagan.peserta2 %}
                                            <span style="font-size: 30px;" class="badge bg-warning">
                                                WAITING
                                            </span>
                                            {% else %}
                                            <a href="{% url 'mulaipenilaian1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                                <button class="btn btn-warning" style="margin-top: -6px; color: white">
                                                    Mulai Penilaian
                                                </button>
                                            </a>
                                        {% endif %}
                                    
                                            <form method="POST" style="display: inline; font-size: 30px;">
                                                {% csrf_token %}
                                                <input type="hidden" name="detailbagan1" value="{{ detailbagan.pk }}">
                                                <button name="submit_button" value="penilaian_ulang1" class="btn btn-warning" style="color: white;">
                                                     <i class="align-middle" data-feather="refresh-ccw"></i>
                                                </button>
                                            </form>
                                    </td>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    {% else %}
    <div class="row" style="margin-top: 10px;" >
        <div class="d-flex order-1 order-xxl-1">
            <div class="card flex-fill">
                <div class="card-header">
                    <h5 class="card-title mb-0">Scoring <b>{{ tatami }}</b></h5>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover my-0">
                        <thead>
                            <tr>
                                <th>Nama</th>
                                <th>Jury 1</th>
                                <th>Jury 2</th>
                                <th>Jury 3</th>
                                {% if penilaian_juri != 3 %}
                                <th>Jury 4</th>
                                <th>Jury 5</th>
                                {% endif %}
                                {% if penilaian_juri == 7 %}
                                <th>Jury 6</th>
                                <th>Jury 7</th>
                                {% endif %}
                                <th>Total</th>
                                <th>MISC</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                {% if atlet_count == 1 %}
                                    {% if group1 == 'biru' %}
                                        <b style="color: blue;">{{ atlet1 }}</b>
                                    {% elif group1 == 'merah' %}
                                        <b style="color: red;">{{ atlet1 }}</b>
                                    {% else %}
                                        <b>{{ atlet1 }}</b>
                                    {% endif %}
                                {% elif atlet_count == 2 %}
                                    <b style="color: red;">{{ atlet1 }}</b>
                                {% else %}
                                    <b>{{ atlet1 }}</b>
                                {% endif %}
                                </td>
                                {% if atlet_count == 1 %}
                                    {% if group1 == 'merah' %}
                                    <!-- Score 1 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j1">
                                            {% if score1j1.jury_score %}
                                                {% if score1j1.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j1.jury_score }}</span>
                                                {% elif score1j1.terendah %}
                                                <span class="badge bg-danger">{{ score1j1.jury_score }}</span>
                                                {% else %}
                                                {{ score1j1.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 2 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j2">
                                            {% if score1j2.jury_score %}
                                                {% if score1j2.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j2.jury_score }}</span>
                                                {% elif score1j2.terendah %}
                                                <span class="badge bg-danger">{{ score1j2.jury_score }}</span>
                                                {% else %}
                                                {{ score1j2.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 3 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j3">
                                            {% if score1j3.jury_score %}
                                                {% if score1j3.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j3.jury_score }}</span>
                                                {% elif score1j3.terendah %}
                                                <span class="badge bg-danger">{{ score1j3.jury_score }}</span>
                                                {% else %}
                                                {{ score1j3.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% if penilaian_juri != 3 %}
                                    <!-- Score 4 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j4">
                                            {% if score1j4.jury_score %}
                                                {% if score1j4.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j4.jury_score }}</span>
                                                {% elif score1j4.terendah %}
                                                <span class="badge bg-danger">{{ score1j4.jury_score }}</span>
                                                {% else %}
                                                {{ score1j4.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 5 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j5">
                                            {% if score1j5.jury_score %}
                                                {% if score1j5.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j5.jury_score }}</span>
                                                {% elif score1j5.terendah %}
                                                <span class="badge bg-danger">{{ score1j5.jury_score }}</span>
                                                {% else %}
                                                {{ score1j5.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% endif %}
                                    {% if penilaian_juri == 7 %}
                                    <!-- Score 6 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j6">
                                            {% if score1j6.jury_score %}
                                                {% if score1j6.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j6.jury_score }}</span>
                                                {% elif score1j6.terendah %}
                                                <span class="badge bg-danger">{{ score1j6.jury_score }}</span>
                                                {% else %}
                                                {{ score1j6.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 7 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j7">
                                            {% if score1j7.jury_score %}
                                                {% if score1j7.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j7.jury_score }}</span>
                                                {% elif score1j7.terendah %}
                                                <span class="badge bg-danger">{{ score1j7.jury_score }}</span>
                                                {% else %}
                                                {{ score1j7.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% endif %}
                                    <td>
                                        <span id="totalscore1" class="badge bg-dark" style="font-size: 30px;">
                                            {% if totalscore1 == '00.0' %}
                                                00.0
                                            {% else %}
                                                {{ totalscore1.total }}
                                            {% endif %}
                                        </span>
                                    </td>
                                    {% else %}
                                    <!-- Score 1 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j1">
                                            {% if score2j1.jury_score %}
                                                {% if score2j1.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j1.jury_score }}</span>
                                                {% elif score2j1.terendah %}
                                                <span class="badge bg-danger">{{ score2j1.jury_score }}</span>
                                                {% else %}
                                                {{ score2j1.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 2 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j2">
                                            {% if score2j2.jury_score %}
                                                     {% if score2j2.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j2.jury_score }}</span>
                                                {% elif score2j2.terendah %}
                                                <span class="badge bg-danger">{{ score2j2.jury_score }}</span>
                                                {% else %}
                                                {{ score2j2.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 3 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j3">
                                            {% if score2j3.jury_score %}
                                                {% if score2j3.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j3.jury_score }}</span>
                                                {% elif score2j3.terendah %}
                                                <span class="badge bg-danger">{{ score2j3.jury_score }}</span>
                                                {% else %}
                                                {{ score2j3.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% if penilaian_juri != 3 %}
                                    <!-- Score 4 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j4">
                                            {% if score2j4.jury_score %}
                                                {% if score2j4.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j4.jury_score }}</span>
                                                {% elif score2j4.terendah %}
                                                <span class="badge bg-danger">{{ score2j4.jury_score }}</span>
                                                {% else %}
                                                {{ score2j4.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 5 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j5">
                                            {% if score2j5.jury_score %}
                                                {% if score2j5.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j5.jury_score }}</span>
                                                {% elif score2j5.terendah %}
                                                <span class="badge bg-danger">{{ score2j5.jury_score }}</span>
                                                {% else %}
                                                {{ score2j5.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% endif %}
                                    {% if penilaian_juri == 7 %}
                                    <!-- Score 6 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j6">
                                            {% if score2j6.jury_score %}
                                                {% if score2j6.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j6.jury_score }}</span>
                                                {% elif score2j6.terendah %}
                                                <span class="badge bg-danger">{{ score2j6.jury_score }}</span>
                                                {% else %}
                                                {{ score2j6.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 7 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j7">
                                            {% if score2j7.jury_score %}
                                                {% if score2j7.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j7.jury_score }}</span>
                                                {% elif score2j7.terendah %}
                                                <span class="badge bg-danger">{{ score2j7.jury_score }}</span>
                                                {% else %}
                                                {{ score2j7.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% endif %}
                                    <td>
                                        <span id="totalscore2" class="badge bg-dark" style="font-size: 30px;">
                                            {% if totalscore2 == '00.0' %}
                                                00.0
                                            {% else %}
                                                {{ totalscore2.total }}
                                            {% endif %}
                                        </span>
                                    </td>
                                    {% endif %}
                                {% endif %}
                                {% if atlet_count == 1 %}
                                    {% if group1 == 'merah' %}
                                        <td id="penilaianbtn1" data-url="{% url 'mulaipenilaian1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                    {% else %}
                                        <td id="penilaianbtn2" data-url="{% url 'mulaipenilaian2' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                    {% endif %}
                                {% endif %}


                                {% if atlet_count == 2 %}
                                    <!-- Score 1 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j1">
                                            {% if score1j1.jury_score %}
                                                {% if score1j1.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j1.jury_score }}</span>
                                                {% elif score1j1.terendah %}
                                                <span class="badge bg-danger">{{ score1j1.jury_score }}</span>
                                                {% else %}
                                                {{ score1j1.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 2 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j2">
                                            {% if score1j2.jury_score %}
                                                {% if score1j2.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j2.jury_score }}</span>
                                                {% elif score1j2.terendah %}
                                                <span class="badge bg-danger">{{ score1j2.jury_score }}</span>
                                                {% else %}
                                                {{ score1j2.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 3 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j3">
                                            {% if score1j3.jury_score %}
                                                {% if score1j3.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j3.jury_score }}</span>
                                                {% elif score1j3.terendah %}
                                                <span class="badge bg-danger">{{ score1j3.jury_score }}</span>
                                                {% else %}
                                                {{ score1j3.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% if penilaian_juri != 3 %}
                                    <!-- Score 4 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j4">
                                            {% if score1j4.jury_score %}
                                                {% if score1j4.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j4.jury_score }}</span>
                                                {% elif score1j4.terendah %}
                                                <span class="badge bg-danger">{{ score1j4.jury_score }}</span>
                                                {% else %}
                                                {{ score1j4.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 5 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j5">
                                            {% if score1j5.jury_score %}
                                                {% if score1j5.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j5.jury_score }}</span>
                                                {% elif score1j5.terendah %}
                                                <span class="badge bg-danger">{{ score1j5.jury_score }}</span>
                                                {% else %}
                                                {{ score1j5.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% endif %}
                                    {% if penilaian_juri == 7 %}
                                    <!-- Score 6 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j6">
                                            {% if score1j6.jury_score %}
                                                {% if score1j6.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j6.jury_score }}</span>
                                                {% elif score1j6.terendah %}
                                                <span class="badge bg-danger">{{ score1j6.jury_score }}</span>
                                                {% else %}
                                                {{ score1j6.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 7 -->
                                    <td style="font-size: 30px;">
                                        <b id="score1j7">
                                            {% if score1j7.jury_score %}
                                                {% if score1j7.tertinggi %}
                                                <span class="badge bg-primary">{{ score1j7.jury_score }}</span>
                                                {% elif score1j7.terendah %}
                                                <span class="badge bg-danger">{{ score1j7.jury_score }}</span>
                                                {% else %}
                                                {{ score1j7.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% endif %}
                                    <td>
                                        <span id="totalscore1" class="badge bg-dark" style="font-size: 30px;">
                                            {% if totalscore1 == '00.0' %}
                                                00.0
                                            {% else %}
                                                {{ totalscore1.total }}
                                            {% endif %}
                                        </span>
                                    </td>
                                    <td id="penilaianbtn1" data-url="{% url 'mulaipenilaian1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                        {% if detailbagan.peserta1 and not detailbagan.peserta1_telahdinilai %}
                                            <a href="{% url 'mulaipenilaian1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                                <span style="font-size: 30px;" class="badge bg-success">
                                                    NOW
                                                </span>
                                            </a>
                                        {% elif detailbagan.peserta1_telahdinilai %}
                                            <span style="font-size: 20px;" class="badge bg-success">
                                                Telah Dinilai
                                            </span>
                                            {% elif detailbagan.peserta2 %}
                                            <span style="font-size: 30px;" class="badge bg-warning">
                                                WAITING
                                            </span>
                                            {% else %}
                                            <a href="{% url 'mulaipenilaian1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                                <button class="btn btn-warning" style="margin-top: -6px; color: white">
                                                    Mulai Penilaian
                                                </button>
                                            </a>
                                            {% endif %}
                                            <form method="POST" style="display: inline; font-size: 30px;">
                                                {% csrf_token %}
                                                <input type="hidden" name="detailbagan1" value="{{ detailbagan.pk }}">
                                                <button name="submit_button" value="penilaian_ulang1" class="btn btn-warning" style="color: white;">
                                                     <i class="align-middle" data-feather="refresh-ccw"></i>
                                                </button>
                                            </form>
                                    </td>
                                    {% else %}
                                        {% if detailbagan.peserta1 and not detailbagan.peserta1_telahdinilai or detailbagan.peserta2 and not detailbagan.peserta2_telahdinilai %}
                                            <span style="font-size: 30px;" class="badge bg-success">
                                                NOW
                                            </span>
                                        {% else %}
                                            {% if group1 == 'merah' and not detailbagan.peserta1_telahdinilai %}
                                                <a href="{% url 'mulaipenilaian1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                                    <button class="btn btn-warning" style="margin-top: -6px; color: white">
                                                        Mulai Penilaian
                                                    </button>
                                                </a>
                                            {% elif group1 == 'biru' and not detailbagan.peserta2_telahdinilai %}
                                                <a href="{% url 'mulaipenilaian2' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                                    <button class="btn btn-warning" style="margin-top: -6px; color: white">
                                                        Mulai Penilaian
                                                    </button>
                                                </a>
                                            {% else %}
                                                <span style="font-size: 20px" class="badge bg-success">
                                                    Telah Dinilai
                                                </span>
                                                
                                                {% endif %}
                                                {% endif %}
                                                <form method="POST" style="display: inline; font-size: 30px;">
                                                    {% csrf_token %}
                                                    <input type="hidden" name="detailbagan1" value="{{ detailbagan.pk }}">
                                                    <button name="submit_button" value="penilaian_ulang1" class="btn btn-warning" style="color: white;">
                                                        <i class="align-middle" data-feather="refresh-ccw"></i>
                                                    </button>
                                                    
                                                </form>
                                    {% endif %}
                                </td>
                            </tr>

                            {% if detailbagan.id_atlet.count == 2 %}
                            <tr>
                                <td><b style="color: blue;">{{ atlet2 }}</b></td>
                                <!-- Score 1 -->
                                <td style="font-size: 30px;">
                                    <b id="score2j1">
                                        {% if score2j1.jury_score %}
                                            {% if score2j1.tertinggi %}
                                            <span class="badge bg-primary">{{ score2j1.jury_score }}</span>
                                            {% elif score2j1.terendah %}
                                            <span class="badge bg-danger">{{ score2j1.jury_score }}</span>
                                            {% else %}
                                            {{ score2j1.jury_score }}
                                            {% endif %}
                                        {% else %}
                                            0.0
                                        {% endif %}
                                    </b>
                                </td>
                                <!-- Score 2 -->
                                <td style="font-size: 30px;">
                                    <b id="score2j2">
                                        {% if score2j2.jury_score %}    
                                            {% if score2j2.tertinggi %}
                                            <span class="badge bg-primary">{{ score2j2.jury_score }}</span>
                                            {% elif score2j2.terendah %}
                                            <span class="badge bg-danger">{{ score2j2.jury_score }}</span>
                                            {% else %}
                                            {{ score2j2.jury_score }}
                                            {% endif %}
                                        {% else %}
                                            0.0
                                        {% endif %}
                                    </b>
                                </td>
                                <!-- Score 3 -->
                                <td style="font-size: 30px;">
                                    <b id="score2j3">
                                        {% if score2j3.jury_score %}    
                                            {% if score2j3.tertinggi %}
                                            <span class="badge bg-primary">{{ score2j3.jury_score }}</span>
                                            {% elif score2j3.terendah %}
                                            <span class="badge bg-danger">{{ score2j3.jury_score }}</span>
                                            {% else %}
                                            {{ score2j3.jury_score }}
                                            {% endif %}
                                        {% else %}
                                            0.0
                                        {% endif %}
                                    </b>
                                </td>
                                {% if penilaian_juri != 3 %}
                                <!-- Score 4 -->
                                <td style="font-size: 30px;">
                                    <b id="score2j4">
                                        {% if score2j4.jury_score %}
                                            {% if score2j4.tertinggi %}
                                            <span class="badge bg-primary">{{ score2j4.jury_score }}</span>
                                            {% elif score2j4.terendah %}
                                            <span class="badge bg-danger">{{ score2j4.jury_score }}</span>
                                            {% else %}
                                            {{ score2j4.jury_score }}
                                            {% endif %}
                                        {% else %}
                                            0.0
                                        {% endif %}
                                </td>
                                <!-- Score 5 -->
                                <td style="font-size: 30px;">
                                    <b id="score2j5">
                                        {% if score2j5.jury_score %}
                                            {% if score2j5.tertinggi %}
                                            <span class="badge bg-primary">{{ score2j5.jury_score }}</span>
                                            {% elif score2j5.terendah %}
                                            <span class="badge bg-danger">{{ score2j5.jury_score }}</span>
                                            {% else %}
                                            {{ score2j5.jury_score }}
                                            {% endif %}
                                        {% else %}
                                            0.0
                                        {% endif %}
                                    </b>
                                </td>
                                {% endif %}
                                {% if penilaian_juri == 7 %}
                                    <!-- Score 6 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j6">
                                            {% if score2j6.jury_score %}
                                                {% if score2j6.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j6.jury_score }}</span>
                                                {% elif score2j6.terendah %}
                                                <span class="badge bg-danger">{{ score2j6.jury_score }}</span>
                                                {% else %}
                                                {{ score2j6.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    <!-- Score 7 -->
                                    <td style="font-size: 30px;">
                                        <b id="score2j7">
                                            {% if score2j7.jury_score %}
                                                {% if score2j7.tertinggi %}
                                                <span class="badge bg-primary">{{ score2j7.jury_score }}</span>
                                                {% elif score2j7.terendah %}
                                                <span class="badge bg-danger">{{ score2j7.jury_score }}</span>
                                                {% else %}
                                                {{ score2j7.jury_score }}
                                                {% endif %}
                                            {% else %}
                                            0.0
                                            {% endif %}
                                        </b>
                                    </td>
                                    {% endif %}
                                <td>
                                    <span id="totalscore2" class="badge bg-dark" style="font-size: 30px;">
                                        {% if totalscore2 == '00.0' %}
                                            00.0
                                        {% else %}
                                            {{ totalscore2.total }}
                                        {% endif %}
                                    </span>
                                </td>
                                <td id="penilaianbtn2" data-url="{% url 'mulaipenilaian2' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                    {% if detailbagan.peserta2 and not detailbagan.peserta2_telahdinilai %}
                                        <a href="{% url 'mulaipenilaian2' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                            <span style="font-size: 30px;" class="badge bg-success">
                                                NOW
                                            </span>
                                        </a>
                                    {% elif detailbagan.peserta2_telahdinilai %}
                                        <span style="font-size: 20px;" class="badge bg-success">
                                            Telah Dinilai
                                        </span>
                                        {% elif detailbagan.peserta1 %}
                                        <span style="font-size: 30px;" class="badge bg-warning">
                                            WAITING
                                        </span>
                                        {% else %}
                                        <a href="{% url 'mulaipenilaian2' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
                                            <button class="btn btn-warning" style="margin-top: -6px; color: white">
                                                Mulai Penilaian
                                            </button>
                                        </a>
                                        {% endif %}
                                        <form method="POST" style="display: inline; font-size: 30px; ">
                                            {% csrf_token %}
                                            <input type="hidden" name="detailbagan2" value="{{ detailbagan.pk }}">
                                            <button name="submit_button" value="penilaian_ulang2" class="btn btn-warning" style="color: white;">
                                                <i class="align-middle" data-feather="refresh-ccw"></i>
                                            </button>
                                        </form>
                                </td>
                            </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <form style="margin-bottom: 10px;" class="form-inline" method="POST">
        {% csrf_token %}
        {% if detailbagan.id_atlet.count == 2 %}
        <div class="form-group">
            <select class="form-control" name="warna">
                <option value="">Pilih Peserta</option>
                <option value="aka">Aka</option>
                <option value="ao">Ao</option>
            </select>
        </div>
        {% else %}
        {% endif %}
        <div style="margin-left: 10px;" class="form-group">
            <input placeholder="Input Nama Kata" name="input_kata" type="text" class="form-control">
        </div>
        <div style="margin-left: 10px;" class="form-group">
            <button name="submit_button" value="submit_kata" class="btn btn-dark">
                Submit
            </button>
        </div>
    </form>

    <br>

    {% if putra_url in request.path and kategori.judul_kategori == kategori.judul_kategori %}
        <a href="{% url 'keldetailbagan' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' pk=bagan.pk %}">
          <button class="btn btn-danger">
            <i class="align-middle me-2" data-feather="arrow-left"></i>Kembali
          </button>
        </a>
    {% elif putri_url in request.path and kategori.judul_kategori == kategori.judul_kategori %}
        <a href="{% url 'keldetailbagan' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putri' pk=bagan.pk %}">
          <button class="btn btn-danger">
            <i class="align-middle me-2" data-feather="arrow-left"></i>Kembali
          </button>
        </a>
    {% endif %}
    {% if putra_url in request.path and kategori.judul_kategori == kategori.judul_kategori %}
    <a href="{% url 'leavecontrolpanel' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
    {% elif putri_url in request.path and kategori.judul_kategori == kategori.judul_kategori %}
    <a href="{% url 'leavecontrolpanel' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putri' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}">
    {% endif %}
        <button class="btn btn-dark" style="color: white;">
            <i class="align-middle" data-feather=""></i>
            Selesaikan Penilaian
        </button>
    </a>
    <button onClick="window.location.href=window.location.href" class="btn btn-success" style="color: white;">
        <i class="align-middle" data-feather=""></i>
        Refresh
    </button>

    <hr>

    <h1 class="h3 mb-3"><strong>Control Panel Scoring Board: </strong></h1>

    <script>
        function openNewTab1(detail_bagan_pk) {
            var button = event.target;
            var url = button.getAttribute('data-url');
            url = url.replace('detailbagan_pk', detail_bagan_pk);
            window.open(url, "_blank");
        }
    </script>  

    <div style="margin-top: 10px;">
        <button class="btn btn-primary" id="startButton">
            <i class="align-middle" data-feather="play"></i>
            Start Timer
        </button>
        <button class="btn btn-danger" id="pauseButton">
            <i class="align-middle" data-feather="pause"></i>
            Pause Timer
        </button>
        <button class="btn btn-success" id="resetButton">
            <i class="align-middle" data-feather=""></i>
            Reset Timer
        </button>
    </div>
    <div style="margin-top: 10px;">
    <button class="btn btn-dark" id="tampilkanButton" style="color: white;">
        <i class="align-middle" data-feather="eye"></i>
        Tampilkan Nilai ke Scoringboard
    </button>
</div>


    <div style="color: black;">
        {% for score1 in score1 %}
            {{ score1.jury_score }}
        {% endfor %}
    </div>
    <div style="color: black;">
        {% for score2 in score2 %}
            {{ score2.jury_score }}
        {% endfor %}
    </div>

    {% comment %} <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> {% endcomment %}
    <script src="{% static 'jquery/jquery.min.js' %}"></script>
    <script>
       $(document).ready(function() {
            
            var csrftoken = $('[name=csrfmiddlewaretoken]').val();  // Fetch the CSRF token
            var startUrl = "{% url 'starttimer1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}";
            var pauseUrl = "{% url 'pausetimer1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}";
            var resetUrl = "{% url 'resettimer1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}";
            var tampilkanUrl = "{% url 'tampilkan1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}"; 
            
            $("#startButton").click(function() {
                $.ajax({
                    url: startUrl,
                    method: "POST",
                    headers: { "X-CSRFToken": csrftoken },  // Pass the CSRF token in the headers
                    success: function(data) {
                        console.log("Timer started successfully");
                        }
                    });
                });


           $("#pauseButton").click(function() {
               $.ajax({
                    url: pauseUrl,
                    method: "POST",
                    headers: { "X-CSRFToken": csrftoken },  // Pass the CSRF token in the headers
                    success: function(data) {
                        console.log("Timer paused successfully");
                    }
                });
            });

            $("#resetButton").click(function() {
                $.ajax({
                     url: resetUrl,
                     method: "POST",
                     headers: { "X-CSRFToken": csrftoken },  // Pass the CSRF token in the headers
                     success: function(data) {
                         console.log("Timer reset successfully");
                     }
                 });
             });

            $("#tampilkanButton").click(function() {
               $.ajax({
                    url: tampilkanUrl,
                    method: "POST",
                    headers: { "X-CSRFToken": csrftoken },  // Pass the CSRF token in the headers
                    success: function(data) {
                        console.log("Tampilkan");
                    }
                });
            });
        });
    </script>

    <div hidden>
        <p id="event-slug">{{ event.slug }}</p>
        <p id="kategori-slug">{{ kategori.slug }}</p>
        {% if putra_url in request.path %}
        <p id="jenis-kelamin">putra</p>
        {% elif putri_url in request.path %}
        <p id="jenis-kelamin">putri</p>
        {% endif %}
        <p id="bagan-pk">{{ bagan.pk }}</p>
        <p id="detail-bagan-pk">{{ detailbagan.pk }}</p>
        <p id="tatami-pk">{{ tatami.pk }}</p>
    </div>

    {% block scripts %}
    <script>
        const timerSound = document.getElementById('timerSound');
        const eventSlug = document.getElementById('event-slug').textContent.trim()
        const kategoriSlug = document.getElementById('kategori-slug').textContent.trim()
        const jenisKelamin = document.getElementById('jenis-kelamin').textContent.trim()
        const baganPk = document.getElementById('bagan-pk').textContent.trim()
        const detailbaganPk = document.getElementById('detail-bagan-pk').textContent.trim()
        const tatamiPk = document.getElementById('tatami-pk').textContent.trim()
        var totalnilaiUrl = "{% url 'totalnilai1' event_slug=event.slug kategori_slug=kategori.slug jenis_kelamin='putra' bagan_pk=bagan.pk detailbagan_pk=detailbagan.pk tatami_pk=tatami.pk %}"; 
        
        // Ini koneksi websocket!!!
        const socket = new WebSocket(`ws://${window.location.host}/ws/kelevent/${eventSlug}/kata/${kategoriSlug}/${jenisKelamin}/${baganPk}/${detailbaganPk}/${tatamiPk}/`);
    
        console.log(socket)

        // Window onopen
        socket.onopen = function(e) {
            socket.send(JSON.stringify({
                'command': 'fetch_data',
            }));
        };
        
        // Ini data dari server di mashook-in ke 
        socket.onmessage = function(e) {
            const data = JSON.parse(e.data)

            // Define an array for each set of elements
            const benderaSets = [
            ["bendera1merah", "bendera1biru", "bendera1"],
            ["bendera2merah", "bendera2biru", "bendera2"],
            ["bendera3merah", "bendera3biru", "bendera3"],
            ["bendera4merah", "bendera4biru", "bendera4"],
            ["bendera5merah", "bendera5biru", "bendera5"],
            ["bendera6merah", "bendera6biru", "bendera6"],
            ["bendera7merah", "bendera7biru", "bendera7"],
            ];

            // Iterate through each set of elements
            for (let i = 0; i < benderaSets.length; i++) {
                const [merahId, biruId, mainId] = benderaSets[i];

                // Get references to the elements
                const merahElement = document.getElementById(merahId);
                const biruElement = document.getElementById(biruId);
                const mainElement = document.getElementById(mainId);

                // Check conditions and update styles accordingly
                if (data.message1 === 20 && data.sender === i + 1) {
                    merahElement.style = "";
                    mainElement.style = "display: none;";
                } else if (data.message1 === 30 && data.sender === i + 1) {
                    biruElement.style = "";
                    mainElement.style = "display: none;";
                }
            }

            var benderamerah = document.getElementById('benderamerah')
            var benderabiru = document.getElementById('benderabiru')
            var bendera = document.getElementById('bendera')

            const senderMap = {
                1: ["score1j1", "score2j1"],
                2: ["score1j2", "score2j2"],
                3: ["score1j3", "score2j3"],
                4: ["score1j4", "score2j4"],
                5: ["score1j5", "score2j5"],
                6: ["score1j6", "score2j6"],
                7: ["score1j7", "score2j7"],
            };
            

            if (senderMap[data.sender]) {
                const [element1, element2] = senderMap[data.sender];

                if (data.message1) {
                    document.getElementById(element1).innerHTML = data.message1;
                }
            
                if (data.message2) {
                    document.getElementById(element2).innerHTML = data.message2;
                }
                
            } else {
                console.log('ERROR');
            }
            
            console.log(data.valid)
            if (data.valid === 'yes') {
                console.log('worked!')
                $.ajax({
                    url: totalnilaiUrl,
                    method: "GET",
                    success: function(data) {
                        const element1 = document.getElementById("totalscore1");
                        const element2 = document.getElementById("totalscore2");
                        const banyaknya_juri = document.getElementById("banyaknya_juri");

                        if (banyaknya_juri.textContent === '3') {
                            console.log(data.winner)
                            if (element1 !== null) {
                                element1.innerHTML = data.totalnilai1;
    
                                if (data.totalnilai1 == '00.0') {
                                    console.log('Score peserta 1 tidak ada.')
                                } else {
                                    console.log('hi there 1')

                                    if (data.winner !== 'none') {
                                        if (data.winner === 'merah') {
                                            benderamerah.style = ""
                                            bendera.style = "display: none"
                                        } else {
                                            benderabiru.style = ""
                                            bendera.style = "display: none"
                                        }
                                    }
    
                                    if (data.totalnilai2 == '00.0') {
                                        const validate2 = document.getElementById("penilaianbtn2");
    
                                        if (validate2 !== null) {
    
                                            var url2a = document.getElementById("penilaianbtn2");
                                                var url2 = url2a.getAttribute('data-url');
                                                console.log('ahhh')
                                                console.log('asdjkfhsajdfhljksad')
                                                url2a.innerHTML = `<a href="${url2}">
                                                        <button class="btn btn-warning">
                                                            Mulai Penilaian
                                                        </button>
                                                                    </a>`
                                        }
                                    }
    
                                    document.getElementById("penilaianbtn1").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;

                                    const scores = [];
                                    for (let i = 1; i <= 3; i++) {
                                        scores.push(parseFloat(document.getElementById(`score1j${i}`).textContent.trim()));
                                    }
                                    const highestScore = Math.max(...scores);
                                    const lowestScore = Math.min(...scores);
                                    let highestIndex = -1;
                                    let lowestIndex = -1;
                                    for (let i = 0; i < scores.length; i++) {
                                        if (scores[i] === highestScore) {
                                        highestIndex = i;
                                        break;
                                        }
                                    }
                                    for (let i = 0; i < scores.length; i++) {
                                        if (scores[i] === lowestScore) {
                                        lowestIndex = i;
                                        break;
                                        }
                                    }
                                    for (let i = 0; i < scores.length; i++) {
                                        const element = document.getElementById(`score1j${i + 1}`);
                                    
                                        if (i === highestIndex) {
                                        element.innerHTML = `<span class="badge bg-primary">${scores[i]}</span>`;
                                        } else if (i === lowestIndex) {
                                        element.innerHTML = `<span class="badge bg-danger">${scores[i]}</span>`;
                                        }
                                    }

                                }
                            } else {
                                console.log("Element dengan ID totalnilai1 tidak ada.");
                            }
    
                            if (element2 !== null) {
                                element2.innerHTML = data.totalnilai2;
    
                                if (data.totalnilai2 == '00.0') {
                                    console.log('Score peserta 2 tidak ada.')
                                } else {
                                    console.log('hi there 2')
                                    var url1a = document.getElementById("penilaianbtn1");
    
                                    if (url1a !== null) {
    
                                        console.log('test2')
    
                                        var url1 = url1a.getAttribute('data-url');
    
                                        document.getElementById("penilaianbtn2").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;
                                        const scores1 = [];
                                        for (let i = 1; i <= 3; i++) {
                                            scores1.push(parseFloat(document.getElementById(`score2j${i}`).textContent.trim()));
                                        }
                                        const highestScore1 = Math.max(...scores1);
                                        const lowestScore1 = Math.min(...scores1);
                                        let highestIndex1 = -1;
                                        let lowestIndex1 = -1;
                                        for (let i = 0; i < scores1.length; i++) {
                                            if (scores1[i] === highestScore1) {
                                            highestIndex1 = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores1.length; i++) {
                                            if (scores1[i] === lowestScore1) {
                                            lowestIndex1 = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores1.length; i++) {
                                            const element = document.getElementById(`score2j${i + 1}`);
                                        
                                            if (i === highestIndex1) {
                                            element.innerHTML = `<span class="badge bg-primary">${scores1[i]}</span>`;
                                            } else if (i === lowestIndex1) {
                                            element.innerHTML = `<span class="badge bg-danger">${scores1[i]}</span>`;
                                            }
                                        }

                                    } else {
                                        console.log('hi there 3')
                                        var url2a = document.getElementById("penilaianbtn2");
                                        var url2 = url2a.getAttribute('data-url');
                                        url2a.innerHTML = `<a href="${url2}">
                                                <button class="btn btn-warning">
                                                    Mulai Penilaian
                                                </button>
                                                            </a>`
    
                                        console.log('test1')
    
                                        document.getElementById("penilaianbtn2").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;
                                        const scores1 = [];
                                        for (let i = 1; i <= 3; i++) {
                                            scores1.push(parseFloat(document.getElementById(`score2j${i}`).textContent.trim()));
                                        }
                                        const highestScore1 = Math.max(...scores1);
                                        const lowestScore1 = Math.min(...scores1);
                                        let highestIndex1 = -1;
                                        let lowestIndex1 = -1;
                                        for (let i = 0; i < scores1.length; i++) {
                                            if (scores1[i] === highestScore1) {
                                            highestIndex1 = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores1.length; i++) {
                                            if (scores1[i] === lowestScore1) {
                                            lowestIndex1 = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores1.length; i++) {
                                            const element = document.getElementById(`score2j${i + 1}`);
                                        
                                            if (i === highestIndex1) {
                                            element.innerHTML = `<span class="badge bg-primary">${scores1[i]}</span>`;
                                            } else if (i === lowestIndex1) {
                                            element.innerHTML = `<span class="badge bg-danger">${scores1[i]}</span>`;
                                            }
                                        }
                                    }
                                }
    
                            } else {
                                console.log("Element dengan ID totalnilai2 tidak ada.");
                            }
                        } 
                        else if (banyaknya_juri.textContent === '7') {
                            console.log('7 juri')
                            if (element1 !== null) {
                                element1.innerHTML = data.totalnilai1;
    
                                if (data.totalnilai1 == '00.0') {
                                    console.log('Score peserta 1 tidak ada.')
                                } else {
                                    console.log('hi there 1')
    
                                    if (data.totalnilai2 == '00.0') {
                                        const validate2 = document.getElementById("penilaianbtn2");
    
                                        if (validate2 !== null) {
    
                                            var url2a = document.getElementById("penilaianbtn2");
                                                var url2 = url2a.getAttribute('data-url');
                                                console.log('ahhh')
                                                console.log('asdjkfhsajdfhljksad')
                                                url2a.innerHTML = `<a href="${url2}">
                                                        <button class="btn btn-warning">
                                                            Mulai Penilaian
                                                        </button>
                                                                    </a>`
                                        }
                                    }
    
                                    document.getElementById("penilaianbtn1").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;

                                    const scores = [];
                                    for (let i = 1; i <= 7; i++) {
                                        scores.push(parseFloat(document.getElementById(`score1j${i}`).textContent.trim()));
                                    }
                                    const highestScore = Math.max(...scores);
                                    const lowestScore = Math.min(...scores);
                                    let highestIndex = -1;
                                    let lowestIndex = -1;
                                    for (let i = 0; i < scores.length; i++) {
                                        if (scores[i] === highestScore) {
                                        highestIndex = i;
                                        break;
                                        }
                                    }
                                    for (let i = 0; i < scores.length; i++) {
                                        if (scores[i] === lowestScore) {
                                        lowestIndex = i;
                                        break;
                                        }
                                    }
                                    for (let i = 0; i < scores.length; i++) {
                                        const element = document.getElementById(`score1j${i + 1}`);
                                    
                                        if (i === highestIndex) {
                                        element.innerHTML = `<span class="badge bg-primary">${scores[i]}</span>`;
                                        } else if (i === lowestIndex) {
                                        element.innerHTML = `<span class="badge bg-danger">${scores[i]}</span>`;
                                        }
                                    }

                                }
                            } else {
                                console.log("Element dengan ID totalnilai1 tidak ada.");
                            }
    
                            if (element2 !== null) {
                                element2.innerHTML = data.totalnilai2;
    
                                if (data.totalnilai2 == '00.0') {
                                    console.log('Score peserta 2 tidak ada.')
                                } else {
                                    console.log('hi there 2')
                                    var url1a = document.getElementById("penilaianbtn1");
    
                                    if (url1a !== null) {
    
                                        console.log('test2')
    
                                        var url1 = url1a.getAttribute('data-url');
    
                                        document.getElementById("penilaianbtn2").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;
                                        const scores1 = [];
                                        for (let i = 1; i <= 7; i++) {
                                            scores1.push(parseFloat(document.getElementById(`score2j${i}`).textContent.trim()));
                                        }
                                        const highestScore1 = Math.max(...scores1);
                                        const lowestScore1 = Math.min(...scores1);
                                        let highestIndex1 = -1;
                                        let lowestIndex1 = -1;
                                        for (let i = 0; i < scores1.length; i++) {
                                            if (scores1[i] === highestScore1) {
                                            highestIndex1 = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores1.length; i++) {
                                            if (scores1[i] === lowestScore1) {
                                            lowestIndex1 = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores1.length; i++) {
                                            const element = document.getElementById(`score2j${i + 1}`);
                                        
                                            if (i === highestIndex1) {
                                            element.innerHTML = `<span class="badge bg-primary">${scores1[i]}</span>`;
                                            } else if (i === lowestIndex1) {
                                            element.innerHTML = `<span class="badge bg-danger">${scores1[i]}</span>`;
                                            }
                                        }

                                    } else {
                                        console.log('hi there 3')
                                        var url2a = document.getElementById("penilaianbtn2");
                                        var url2 = url2a.getAttribute('data-url');
                                        url2a.innerHTML = `<a href="${url2}">
                                                <button class="btn btn-warning">
                                                    Mulai Penilaian
                                                </button>
                                                            </a>`
    
                                        console.log('test1')
    
                                        document.getElementById("penilaianbtn2").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;
                                        const scores1 = [];
                                        for (let i = 1; i <= 7; i++) {
                                            scores1.push(parseFloat(document.getElementById(`score2j${i}`).textContent.trim()));
                                        }
                                        const highestScore1 = Math.max(...scores1);
                                        const lowestScore1 = Math.min(...scores1);
                                        let highestIndex1 = -1;
                                        let lowestIndex1 = -1;
                                        for (let i = 0; i < scores1.length; i++) {
                                            if (scores1[i] === highestScore1) {
                                            highestIndex1 = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores1.length; i++) {
                                            if (scores1[i] === lowestScore1) {
                                            lowestIndex1 = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores1.length; i++) {
                                            const element = document.getElementById(`score2j${i + 1}`);
                                        
                                            if (i === highestIndex1) {
                                            element.innerHTML = `<span class="badge bg-primary">${scores1[i]}</span>`;
                                            } else if (i === lowestIndex1) {
                                            element.innerHTML = `<span class="badge bg-danger">${scores1[i]}</span>`;
                                            }
                                        }
                                    }
                                }
    
                            } else {
                                console.log("Element dengan ID totalnilai2 tidak ada.");
                            }
                        }
                        else {
                            
                            if (data.winner !== 'none') {
                                
                                if (data.winner === 'merah') {
                                    benderamerah.style = ""
                                } else {
                                    benderabiru.style = ""
                                }
                                bendera.style = "display: none;"
                                document.getElementById("penilaianbtn1").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;
                            } else {
                                if (element1 !== null) {
                                    element1.innerHTML = data.totalnilai1;
        
                                    if (data.totalnilai1 == '00.0') {
                                        console.log('Score peserta 1 tidak ada.')
                                    } else {
        
                                        if (data.totalnilai2 == '00.0') {
                                            const validate2 = document.getElementById("penilaianbtn2");
        
                                            if (validate2 !== null) {
        
                                                var url2a = document.getElementById("penilaianbtn2");
                                                    var url2 = url2a.getAttribute('data-url');
                                                    console.log('ahhh')
                                                    console.log('asdjkfhsajdfhljksad')
                                                    url2a.innerHTML = `<a href="${url2}">
                                                            <button class="btn btn-warning">
                                                                Mulai Penilaian
                                                            </button>
                                                                        </a>`
                                            }
                                        }
        
                                        document.getElementById("penilaianbtn1").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;
                                        const scores = [];
                                        for (let i = 1; i <= 5; i++) {
                                            scores.push(parseFloat(document.getElementById(`score1j${i}`).textContent.trim()));
                                        }
                                        const highestScore = Math.max(...scores);
                                        const lowestScore = Math.min(...scores);
                                        let highestIndex = -1;
                                        let lowestIndex = -1;
                                        for (let i = 0; i < scores.length; i++) {
                                            if (scores[i] === highestScore) {
                                            highestIndex = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores.length; i++) {
                                            if (scores[i] === lowestScore) {
                                            lowestIndex = i;
                                            break;
                                            }
                                        }
                                        for (let i = 0; i < scores.length; i++) {
                                            const element = document.getElementById(`score1j${i + 1}`);
                                        
                                            if (i === highestIndex) {
                                            element.innerHTML = `<span class="badge bg-primary">${scores[i]}</span>`;
                                            } else if (i === lowestIndex) {
                                            element.innerHTML = `<span class="badge bg-danger">${scores[i]}</span>`;
                                            }
                                        }
                                        console.log('AHHHHHHHHHHHHHHHH')
                                    }
                                } else {
                                    console.log("Element dengan ID totalnilai1 tidak ada.");
                                }
        
                                if (element2 !== null) {
                                    element2.innerHTML = data.totalnilai2;
        
                                    if (data.totalnilai2 == '00.0') {
                                        console.log('Score peserta 2 tidak ada.')
                                    } else {
                                        var url1a = document.getElementById("penilaianbtn1");
        
                                        if (url1a !== null) {
        
                                            console.log('test2')
        
                                            var url1 = url1a.getAttribute('data-url');
        
                                            document.getElementById("penilaianbtn2").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;
                                            const scores1 = [];
                                            for (let i = 1; i <= 5; i++) {
                                                scores1.push(parseFloat(document.getElementById(`score2j${i}`).textContent.trim()));
                                            }
                                            const highestScore1 = Math.max(...scores1);
                                            const lowestScore1 = Math.min(...scores1);
                                            let highestIndex1 = -1;
                                            let lowestIndex1 = -1;
                                            for (let i = 0; i < scores1.length; i++) {
                                                if (scores1[i] === highestScore1) {
                                                highestIndex1 = i;
                                                break;
                                                }
                                            }
                                            for (let i = 0; i < scores1.length; i++) {
                                                if (scores1[i] === lowestScore1) {
                                                lowestIndex1 = i;
                                                break;
                                                }
                                            }
                                            for (let i = 0; i < scores1.length; i++) {
                                                const element = document.getElementById(`score2j${i + 1}`);
                                            
                                                if (i === highestIndex1) {
                                                element.innerHTML = `<span class="badge bg-primary">${scores1[i]}</span>`;
                                                } else if (i === lowestIndex1) {
                                                element.innerHTML = `<span class="badge bg-danger">${scores1[i]}</span>`;
                                                }
                                            }
                                        } else {
                                            var url2a = document.getElementById("penilaianbtn2");
                                            var url2 = url2a.getAttribute('data-url');
                                            url2a.innerHTML = `<a href="${url2}">
                                                    <button class="btn btn-warning">
                                                        Mulai Penilaian
                                                    </button>
                                                                </a>`
        
                                            console.log('test1')
        
                                            document.getElementById("penilaianbtn2").innerHTML = `<span style="font-size: 30px;" class="badge bg-success">Telah Dinilai</span>`;
                                            const scores1 = [];
                                            for (let i = 1; i <= 5; i++) {
                                                scores1.push(parseFloat(document.getElementById(`score2j${i}`).textContent.trim()));
                                            }
                                            const highestScore1 = Math.max(...scores1);
                                            const lowestScore1 = Math.min(...scores1);
                                            let highestIndex1 = -1;
                                            let lowestIndex1 = -1;
                                            for (let i = 0; i < scores1.length; i++) {
                                                if (scores1[i] === highestScore1) {
                                                highestIndex1 = i;
                                                break;
                                                }
                                            }
                                            for (let i = 0; i < scores1.length; i++) {
                                                if (scores1[i] === lowestScore1) {
                                                lowestIndex1 = i;
                                                break;
                                                }
                                            }
                                            for (let i = 0; i < scores1.length; i++) {
                                                const element = document.getElementById(`score2j${i + 1}`);
                                            
                                                if (i === highestIndex1) {
                                                element.innerHTML = `<span class="badge bg-primary">${scores1[i]}</span>`;
                                                } else if (i === lowestIndex1) {
                                                element.innerHTML = `<span class="badge bg-danger">${scores1[i]}</span>`;
                                                }
                                            }
                                        }
                                    }
        
                                } else {
        
                                    console.log("Element dengan ID totalnilai2 tidak ada.");
        
                                } 
                            }
                        }
                    }
                });
            } else {
                console.log('lsdkflasflkasdf')
                console.log(banyaknya_juri)
            }
        };
    
        socket.onclose = function(e) {
            console.log("WebSocket connection closed.");
        };
    
        socket.onerror = function(e) {
            console.error("WebSocket error:" + e);
        };
    
    </script>
    {% endblock scripts %}

{% endblock content %}
